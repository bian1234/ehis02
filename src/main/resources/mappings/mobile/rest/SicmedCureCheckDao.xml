<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.thinkgem.jeesite.cfq.mobile.rest.dao.SicmedCureCheckDao">

	<sql id="sicmedCureCheckColumns">
		a.id AS "id",
		a.cure_code AS "cureCode",
		a.cure_name AS
		"cureName",
		a.cure_name_py AS "cureNamePY",
		a.check_price_code AS
		"sicmedCurePrice.id",
		a.cure_class_code AS "sicmedCureClass.id",
		a.cure_detail AS "cureDetail",
		a.create_by AS "createBy.id",
		a.create_date AS "createDate",
		a.update_by AS "updateBy.id",
		a.update_date AS "updateDate",
		a.remarks AS "remarks",
		a.del_flag AS
		"delFlag",

		b.price AS "sicmedCurePrice.price",
		c.class_name AS
		"sicmedCureClass.className"
	</sql>

	<sql id="sicmedCureCheckJoins">
		LEFT JOIN sicmed_cure_price b ON b.id=a.check_price_code
		LEFT JOIN sicmed_cure_class c ON c.id=a.cure_class_code
	</sql>

	<select id="get" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		WHERE a.id = #{id}
	</select>

	<select id="getCureCheck" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="cureCode != null and cureCode != ''">
				AND a.cure_code = #{cureCode}
			</if>
		</where>
	</select>

	<select id="findList" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="cureCode != null and cureCode != ''">
				AND a.cure_code = ${cureCode}
			</if>
			<if test="cureName != null and cureName != ''">
				AND a.cure_name = ${cureName}
			</if>
			<if test="cureNamePY != null and cureNamePY != ''">
				AND a.cure_name_py = ${cureNamePY}
			</if>
			<if
				test="sicmedCureClass != null and sicmedCureClass.className != '' and sicmedCureClass.class != null">
				AND c.class_name = #{sicmedCureClass.className}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<!-- 模糊查询带分页web -->
	<select id="findLike" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="cureCode != null and cureCode != ''">
				AND a.cure_code like CONCAT('%','${cureCode}','%' )
			</if>
			<if test="cureName != null and cureName != ''">
				AND a.cure_name like CONCAT('%','${cureName}','%' )
			</if>
			<if test="cureNamePY != null and cureNamePY != ''">
				AND a.cure_name_py like CONCAT('%','${cureNamePY}','%' )
			</if>
			<if
				test="sicmedCureClass != null and sicmedCureClass.className != '' and sicmedCureClass.class != null">
				AND c.class_name = #{sicmedCureClass.className}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>

	<select id="findAllList" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	<!-- Max select -->
	<!-- 设置需要查询的字段 -->
	<sql id="sicmedCureCheckColumns2">
		a.id AS "id",
		a.cure_name AS "cureName"
	</sql>
	<!-- 模糊查询 -->
	<select id="findListLike" resultType="SicmedCureCheck">
		SELECT
		<include refid="sicmedCureCheckColumns2" />
		FROM sicmed_cure_check a
		<include refid="sicmedCureCheckJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="sicmedCureClass != null and sicmedCureClass.id != ''">
				AND a.cure_class_code = #{sicmedCureClass.id}
			</if>
			<if test="cureCode != null and cureCode != ''">
				AND a.cure_code like CONCAT('%','${cureCode}','%' )
			</if>
			<if test="cureName != null and cureName != ''">
				AND a.cure_name like CONCAT('%','${cureName}','%' )
			</if>
			<if test="cureNamePY != null and cureNamePY != ''">
				AND a.cure_name_py like CONCAT('%','${cureNamePY}','%' )
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>



	<insert id="insert">
		INSERT INTO sicmed_cure_check(
		id,
		cure_code,
		cure_name,
		cure_name_py,
		check_price_code,
		cure_class_code,
		cure_detail,
		create_by,
		create_date,
		update_by,
		update_date,
		remarks,
		del_flag
		) VALUES (
		#{id},
		#{cureCode},
		#{cureName},
		#{cureNamePY},
		#{sicmedCurePrice.id},
		#{sicmedCureClass.id},
		#{cureDetail},
		#{createBy.id},
		#{createDate},
		#{updateBy.id},
		#{updateDate},
		#{remarks},
		#{delFlag}
		)
	</insert>

	<update id="update">
		UPDATE sicmed_cure_check SET
		cure_code = #{cureCode},
		cure_name = #{cureName},
		cure_name_py = #{cureNamePY},
		check_price_code
		= #{sicmedCurePrice.id},
		cure_class_code = #{sicmedCureClass.id},
		cure_detail = #{cureDetail},
		update_by = #{updateBy.id},
		update_date =
		#{updateDate},
		remarks = #{remarks}
		WHERE id = #{id}
	</update>

	<update id="delete">
		UPDATE sicmed_cure_check SET
		del_flag =
		#{DEL_FLAG_DELETE}
		WHERE id = #{id}
	</update>

</mapper>