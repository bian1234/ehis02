<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.jeesite.cfq.mobile.rest.dao.SicmedCaseDao">

	<sql id="sicmedCaseColumns">
		a.id AS "id",
		a.patient_code AS "sicmedPatient.id",
		a.case_tell AS "caseTell",
		a.case_history AS "caseHistory",
		a.past_history AS "pastHistory",
		a.case_allergy AS "caseAllergy",
		a.family_allergy AS "familyAllergy",
		a.check_code_body AS "checkCodeBody",
		a.check_code_aid AS "checkCodeAid",
		a.diagnosis_disease_initial AS "diagnosisDiseaseInitial.id",
		a.diagnosis_disease_sure AS "diagnosisDiseaseSure.id",
		a.case_diagnosis AS "caseDiagnosis",
		a.asked_code AS "sicmedAsked.id",
		a.create_user AS "createUser.id",
		a.update_user AS "updateUser.id",
		a.create_by AS "createBy.id",
		a.create_date AS "createDate",
		a.update_by AS "updateBy.id",
		a.update_date AS "updateDate",
		a.remarks AS "remarks" ,
		a.del_flag AS "delFlag",
		<!-- 患者信息 -->
		p.patient_number AS "sicmedPatient.patientNumber",
		p.patient_name AS "sicmedPatient.patientName",
		p.patient_sex AS "sicmedPatient.patientSex",
		p.patient_age AS "sicmedPatient.patientAge",
		p.medicare_type AS "sicmedPatient.medicareType",
		p.medicare_no AS "sicmedPatient.medicareNo",
		p.patient_birthday AS "sicmedPatient.patientBirthday",
		p.patient_card AS "sicmedPatient.patientCard",
		p.patient_firstdate AS "sicmedPatient.patientFirstdate",
		p.patient_lastdate AS "sicmedPatient.patientLastdate",
		p.patient_address AS "sicmedPatient.patientAddress",
		p.patient_tel AS "sicmedPatient.patientTel",
		p.branch_code AS "sicmedPatient.sicmedBranch.id",
		p.doctor_code AS "sicmedPatient.sicmedDoctor.id",
		p.create_user As "sicmedPatient.createUser.id",
		p.update_user As "sicmedPatient.updateUser.id",
		p.create_by AS "sicmedPatient.createBy.id",
		p.create_date AS "sicmedPatient.createDate",
		p.update_by AS "sicmedPatient.updateBy.id",
		p.update_date AS "sicmedPatient.updateDate",
		p.remarks AS "sicmedPatient.remarks",
		p.del_flag AS "sicmedPatient.delFlag",
		<!-- 初步诊断信息 -->
		d.disease_class_code AS "diagnosisDiseaseInitial.diseaseClass.id",
		d.disease_name AS "diagnosisDiseaseInitial.diseaseName",
		d.disease_name_english AS "diagnosisDiseaseInitial.diseaseNameEnglish",
		d.disease_name_pmpa AS "diagnosisDiseaseInitial.diseaseNamePmpa",
		d.disease_code AS "diagnosisDiseaseInitial.diseaseCode",
		d.create_by AS "diagnosisDiseaseInitial.createBy.id",
		d.create_date AS "diagnosisDiseaseInitial.createDate",
		d.update_by AS "diagnosisDiseaseInitial.updateBy.id",
		d.update_date AS "diagnosisDiseaseInitial.updateDate",
		d.remarks AS "diagnosisDiseaseInitial.remarks",
		d.del_flag AS "diagnosisDiseaseInitial.delFlag",
		
		<!-- 创建人和修改人 -->
		u.user_name AS "createUser.userName",
		s.user_name AS "updateUser.userName",
		
		<!-- 医嘱名称 -->
		k.asked_name AS "sicmedAsked.askedName",
		k.asked_class_code AS "sicmedAsked.sicmedAskedClass.id",
		
		<!-- 确认诊断信息 -->
		e.disease_class_code AS "diagnosisDiseaseSure.diseaseClass.id",
		e.disease_name AS "diagnosisDiseaseSure.diseaseName",
		e.disease_name_english AS "diagnosisDiseaseSure.diseaseNameEnglish",
		e.disease_name_pmpa AS "diagnosisDiseaseSure.diseaseNamePmpa",
		e.disease_code AS "diagnosisDiseaseSure.diseaseCode",
		e.create_by AS "diagnosisDiseaseSure.createBy.id",
		e.create_date AS "diagnosisDiseaseSure.createDate",
		e.update_by AS "diagnosisDiseaseSure.updateBy.id",
		e.update_date AS "diagnosisDiseaseSure.updateDate",
		e.remarks AS "diagnosisDiseaseSure.remarks",
		e.del_flag AS "diagnosisDiseaseSure.delFlag",
		
		<!-- 创建者科室信息（丁学志web端接诊记录） -->
		branch.branch_name AS "createUser.sicmedBranch.branch_name"
	</sql>

	<sql id="sicmedCaseJoins">
		LEFT JOIN sicmed_patient p ON p.id = a.patient_code
		LEFT JOIN sicmed_asked k ON k.id = a.asked_code 
		<!-- LEFT JOIN sicmed_asked_class f ON f.id = k.asked_class_code -->
		LEFT JOIN sicmed_user u ON u.id = a.create_user
		LEFT JOIN sicmed_user s ON s.id = a.update_user
	 	LEFT JOIN sicmed_disease d ON d.id = a.diagnosis_disease_initial 
		LEFT JOIN sicmed_disease e ON e.id = a.diagnosis_disease_sure  
		LEFT JOIN (sicmed_user user LEFT JOIN sicmed_branch branch ON user.user_branch = branch.id) ON user.id = a.create_user
	</sql>

	<select id="get" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins" />
		WHERE a.id = #{id}
	</select>
	
	<select id="getByEntity" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="id != null and id != ''">
				AND a.id = #{id}
			</if>
			<if test="sicmedPatient != null and sicmedPatient.id != '' and sicmedPatient.id != null">
				AND a.patient_code = #{sicmedPatient.id}
			</if>
			<if test="caseTell != null and caseTell != ''">
				AND a.case_tell = #{caseTell}
			</if>
			<if test="caseHistory != null and caseHistory != ''">
				AND a.case_history = #{caseHistory}
			</if>
			<if test="pastHistory != null and pastHistory != ''">
				AND a.past_history = #{pastHistory}
			</if>
			<if test="familyAllergy != null and familyAllergy != ''">
				AND a.family_allergy = #{familyAllergy}
			</if>
			<if test="checkCodeBody != null and checkCodeBody != ''">
				AND a.check_code_body = #{checkCodeBody}
			</if>
			<if test="checkCodeAid != null and checkCodeAid != ''">
				AND a.check_code_aid = #{checkCodeAid}
			</if>
			<if
				test="diagnosisDiseaseInitial != null and diagnosisDiseaseInitial != ''">
				AND a.diagnosis_disease_initial = #{diagnosisDiseaseInitial.id}
			</if>
			<if test="diagnosisDiseaseSure != null and diagnosisDiseaseSure != ''">
				AND a.diagnosis_disease_sure = #{diagnosisDiseaseSure.id}
			</if>
			<if test="caseAllergy != null and caseAllergy != ''">
				AND a.case_allergy = #{caseAllergy}
			</if>
			<!-- <if test="caseDiagnosis != null and caseDiagnosis != ''">
				AND a.case_diagnosis = #{caseDiagnosis}
			</if> -->
			<!-- <if test="askedCode != null and askedCode != ''"> AND a.asked_code 
				= #{sicmedAsked.id} </if> -->
			<if test="createBy != null and createBy.id != null and createBy.id != ''">
				AND a.create_by = #{createBy.id}
			</if>
			<if
				test="beginCreateDate != null and endCreateDate != null and beginCreateDate != '' and endCreateDate != ''">
				AND a.create_date BETWEEN #{beginCreateDate} AND
				#{endCreateDate}
			</if>
			<if test="updateBy != null and updateBy.id != null and updateBy.id != ''">
				AND a.update_by = #{updateBy.id}
			</if>
			<if
				test="beginUpdateDate != null and endUpdateDate != null and beginUpdateDate != '' and endUpdateDate != ''">
				AND a.update_date BETWEEN #{beginUpdateDate} AND
				#{endUpdateDate}
			</if>
			<if test="delFlag != null and delFlag != ''">
				AND a.del_flag = #{delFlag}
			</if>
			<if test="createUser != null and createUser.id != '' and createUser.id !=null ">
				AND a.create_user = #{createUser.id}
			</if>
			<if test="updateUser != null and updateUser.id != '' and updateUser.id !=null ">
				AND a.update_user = #{updateUser.id}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	
	<select id="findList" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="id != null and id != ''">
				AND a.id = #{id}
			</if>
			<if test="sicmedPatient != null and sicmedPatient.id != '' and sicmedPatient.id !=null ">
				AND a.patient_code = #{sicmedPatient.id}
			</if>
			<!-- <if test="sicmedPatient != null and sicmedPatient.patientName != '' and sicmedPatient.patientName !=null ">
				AND p.patient_name = #{sicmedPatient.patientName}
			</if> -->
			<if test="sicmedPatient != null and sicmedPatient.patientName != '' and sicmedPatient.patientName !=null ">
				AND p.patient_name = #{sicmedPatient.patientName}
			</if>
			<if test="caseTell != null and caseTell != ''">
				AND a.case_tell = #{caseTell}
			</if>
			<if test="caseHistory != null and caseHistory != ''">
				AND a.case_history = #{caseHistory}
			</if>
			<if test="pastHistory != null and pastHistory != ''">
				AND a.past_history = #{pastHistory}
			</if>
			<if test="familyAllergy != null and familyAllergy != ''">
				AND a.family_allergy = #{familyAllergy}
			</if>
			<if test="checkCodeBody != null and checkCodeBody != ''">
				AND a.check_code_body = #{checkCodeBody}
			</if>
			<if test="checkCodeAid != null and checkCodeAid != ''">
				AND a.check_code_aid = #{checkCodeAid}
			</if>
			<if
				test="diagnosisDiseaseInitial != null and diagnosisDiseaseInitial.id != '' and diagnosisDiseaseInitial.id != null">
				AND a.diagnosis_disease_initial = #{diagnosisDiseaseInitial.id}
			</if>
			<if test="diagnosisDiseaseSure != null and diagnosisDiseaseSure.id != '' and diagnosisDiseaseSure.id != null ">
				AND a.diagnosis_disease_sure = #{diagnosisDiseaseSure.id}
			</if>
			<if test="caseAllergy != null and caseAllergy != ''">
				AND a.case_allergy = #{caseAllergy}
			</if>
			<if test="caseDiagnosis != null and caseDiagnosis != ''">
				AND a.case_diagnosis = #{caseDiagnosis}
			</if>
			<if test="sicmedAsked != null and sicmedAsked.id != '' and sicmedAsked.id != null ">  
				AND a.asked_code = #{sicmedAsked.id} 
			</if>
			<if test="createBy != null and createBy.id != null and createBy.id != ''">
				AND a.create_by = #{createBy.id}
			</if>
			<if
				test="beginCreateDate != null and beginCreateDate != '' ">
				AND a.create_date &gt; #{beginCreateDate}
			</if>
			<if
				test="endCreateDate != null and endCreateDate != ''">
				AND a.create_date &lt; #{endCreateDate} 
			</if>
			<if test="updateBy != null and updateBy.id != null and updateBy.id != ''">
				AND a.update_by = #{updateBy.id}
			</if>
			<if
				test="beginUpdateDate != null and endUpdateDate != null and beginUpdateDate != '' and endUpdateDate != ''">
				AND a.update_date BETWEEN #{beginUpdateDate} AND
				#{endUpdateDate}
			</if>
			<!-- <if test="delFlag != null and delFlag != ''">
				AND a.del_flag = #{delFlag}
			</if> -->
			<if test="createUser != null and createUser.id != '' and createUser.id !=null ">
				AND a.create_user = #{createUser.id}
			</if>
			<!-- <if test="createUser != null and createUser.userName != '' and createUser.userName !=null ">
				AND u.user_name = #{createUser.userName}
			</if> -->
			<if test="createUser != null and createUser.userName != '' and createUser.userName !=null ">
				AND u.user_name = #{createUser.userName}
			</if>
			<if test="updateUser != null and updateUser.id != '' and updateUser.id !=null ">
				AND a.update_user = #{updateUser.id}
			</if>
			<if test="updateUser != null and updateUser.userName != '' and updateUser.userName !=null ">
				AND s.user_name = #{updateUser.userName}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>

	<select id="findAllList" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>

	<insert id="insert">
		INSERT INTO sicmed_case(
		id,
		patient_code,
		case_tell,
		case_history,
		case_allergy,
		past_history,
		family_allergy,
		check_code_body,
		check_code_aid,
		diagnosis_disease_initial,
		diagnosis_disease_sure,
		case_diagnosis,
		asked_code, 
		create_user,
		update_user,
		create_by,
		create_date,
		update_by,
		update_date,
		remarks,
		del_flag
		) VALUES (
		#{id},
		#{sicmedPatient.id},
		#{caseTell},
		#{caseHistory},
		#{caseAllergy},
		#{pastHistory},
		#{familyAllergy},
		#{checkCodeBody},
		#{checkCodeAid},
		#{diagnosisDiseaseInitial.id},
		#{diagnosisDiseaseSure.id},
		#{caseDiagnosis},
		#{sicmedAsked.id},
		#{createUser.id},
		#{updateUser.id},
		#{createBy.id},
		#{createDate},
		#{updateBy.id},
		#{updateDate},
		#{remarks},
		#{delFlag}
		)
	</insert>

	<update id="update">
		UPDATE sicmed_case SET
		patient_code = #{sicmedPatient.id},
		case_tell = #{caseTell},
		case_history = #{caseHistory},
		past_history = #{pastHistory},
		family_allergy = #{familyAllergy},
		check_code_body = #{checkCodeBody},
		check_code_aid = #{checkCodeAid},
		diagnosis_disease_initial = #{diagnosisDiseaseInitial.id},
		diagnosis_disease_sure = #{diagnosisDiseaseSure.id},
		case_allergy = #{caseAllergy},
		case_diagnosis = #{caseDiagnosis},
		asked_code = #{sicmedAsked.id},
		create_user = #{createUser.id},
		update_user = #{updateUser.id},
		update_by =
		#{updateBy.id},
		update_date = #{updateDate},
		remarks =
		#{remarks}
		WHERE id
		= #{id}
	</update>

	<update id="delete">
		UPDATE sicmed_case SET
		del_flag = #{DEL_FLAG_DELETE}
		WHERE id = #{id}
	</update>
	
		<sql id="sicmedCaseColumns1">
		a.id AS "id",
		a.patient_code AS "sicmedPatient.id",
		a.case_tell AS "caseTell",
		a.case_history AS "caseHistory",
		a.past_history AS "pastHistory",
		a.case_allergy AS "caseAllergy",
		a.family_allergy AS "familyAllergy",
		a.check_code_body AS "checkCodeBody",
		a.check_code_aid AS "checkCodeAid",
		a.diagnosis_disease_initial AS "diagnosisDiseaseInitial.id",
		a.diagnosis_disease_sure AS "diagnosisDiseaseSure.id",
		a.case_diagnosis AS "caseDiagnosis",
		a.asked_code AS "sicmedAsked.id",
		a.create_user AS "createUser.id",
		a.update_user AS "updateUser.id",
		a.create_by AS "createBy.id",
		a.create_date AS "createDate",
		a.update_by AS "updateBy.id",
		a.update_date AS "updateDate",
		a.remarks AS "remarks" ,
		a.del_flag AS "delFlag",
		<!-- 患者信息 -->
		p.patient_number AS "sicmedPatient.patientNumber",
		p.patient_name AS "sicmedPatient.patientName",
		p.patient_sex AS "sicmedPatient.patientSex",
		p.patient_age AS "sicmedPatient.patientAge",
		p.medicare_type AS "sicmedPatient.medicareType",
		p.medicare_no AS "sicmedPatient.medicareNo",
		p.patient_birthday AS "sicmedPatient.patientBirthday",
		p.patient_card AS "sicmedPatient.patientCard",
		p.patient_firstdate AS "sicmedPatient.patientFirstdate",
		p.patient_lastdate AS "sicmedPatient.patientLastdate",
		p.patient_address AS "sicmedPatient.patientAddress",
		p.patient_tel AS "sicmedPatient.patientTel",
		p.branch_code AS "sicmedPatient.sicmedBranch.id",
		p.doctor_code AS "sicmedPatient.sicmedDoctor.id",
		p.create_user As "sicmedPatient.createUser.id",
		p.update_user As "sicmedPatient.updateUser.id",
		p.create_by AS "sicmedPatient.createBy.id",
		p.create_date AS "sicmedPatient.createDate",
		p.update_by AS "sicmedPatient.updateBy.id",
		p.update_date AS "sicmedPatient.updateDate",
		p.remarks AS "sicmedPatient.remarks",
		p.del_flag AS "sicmedPatient.delFlag",
		<!-- 初步诊断信息 -->
		d.disease_class_code AS "diagnosisDiseaseInitial.diseaseClass.id",
		d.disease_name AS "diagnosisDiseaseInitial.diseaseName",
		d.disease_name_english AS "diagnosisDiseaseInitial.diseaseNameEnglish",
		d.disease_name_pmpa AS "diagnosisDiseaseInitial.diseaseNamePmpa",
		d.disease_code AS "diagnosisDiseaseInitial.diseaseCode",
		d.create_by AS "diagnosisDiseaseInitial.createBy.id",
		d.create_date AS "diagnosisDiseaseInitial.createDate",
		d.update_by AS "diagnosisDiseaseInitial.updateBy.id",
		d.update_date AS "diagnosisDiseaseInitial.updateDate",
		d.remarks AS "diagnosisDiseaseInitial.remarks",
		d.del_flag AS "diagnosisDiseaseInitial.delFlag",
		
		<!-- 创建人和修改人 -->
		u.user_name AS "createUser.userName",
		s.user_name AS "updateUser.userName",
		
		<!-- 医嘱名称 -->
		k.asked_name AS "sicmedAsked.askedName",
		k.medical_use_code AS "sicmedAsked.sicmedMedicalUse.id",
		k.asked_class_code AS "sicmedAsked.sicmedAskedClass.id",
		k.order_code AS "sicmedAsked.orderCode",
		b.asked_calss AS "sicmedAsked.sicmedAskedClass.askedCalss",
		b.class_number AS "sicmedAsked.sicmedAskedClass.classNumber",
		<!-- 确认诊断信息 -->
		e.disease_class_code AS "diagnosisDiseaseSure.diseaseClass.id",
		e.disease_name AS "diagnosisDiseaseSure.diseaseName",
		e.disease_name_english AS "diagnosisDiseaseSure.diseaseNameEnglish",
		e.disease_name_pmpa AS "diagnosisDiseaseSure.diseaseNamePmpa",
		e.disease_code AS "diagnosisDiseaseSure.diseaseCode",
		e.create_by AS "diagnosisDiseaseSure.createBy.id",
		e.create_date AS "diagnosisDiseaseSure.createDate",
		e.update_by AS "diagnosisDiseaseSure.updateBy.id",
		e.update_date AS "diagnosisDiseaseSure.updateDate",
		e.remarks AS "diagnosisDiseaseSure.remarks",
		e.del_flag AS "diagnosisDiseaseSure.delFlag"
		
	</sql>

	<sql id="sicmedCaseJoins1">
		LEFT JOIN sicmed_patient p ON p.id = a.patient_code
		<!-- LEFT JOIN sicmed_asked k ON k.id = a.asked_code  -->
		RIGHT JOIN (sicmed_asked k LEFT JOIN sicmed_asked_class b ON b.id = k.asked_class_code) ON a.id = k.asked_case_code
		<!-- LEFT JOIN sicmed_asked_class f ON f.id = k.asked_class_code -->
		LEFT JOIN sicmed_user u ON u.id = a.create_user
		LEFT JOIN sicmed_user s ON s.id = a.update_user
	 	LEFT JOIN sicmed_disease d ON d.id = a.diagnosis_disease_initial 
		LEFT JOIN sicmed_disease e ON e.id = a.diagnosis_disease_sure  
	</sql>
	
		<select id="findList1" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns1" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins1" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			AND k.del_flag = #{DEL_FLAG_NORMAL}
			<if test="id != null and id != ''">
				AND a.id = #{id}
			</if>
			<if test="sicmedPatient != null and sicmedPatient.id != '' and sicmedPatient.id !=null ">
				AND a.patient_code = #{sicmedPatient.id}
			</if>
			<!-- <if test="sicmedPatient != null and sicmedPatient.patientName != '' and sicmedPatient.patientName !=null ">
				AND p.patient_name = #{sicmedPatient.patientName}
			</if> -->
			<if test="sicmedPatient != null and sicmedPatient.patientName != '' and sicmedPatient.patientName !=null ">
				AND p.patient_name LIKE CONCAT('%',#{sicmedPatient.patientName},'%')
			</if>
			<if test="sicmedPatient != null and sicmedPatient.patientNumber != '' and sicmedPatient.patientNumber !=null ">
				AND p.patient_number LIKE CONCAT('%',#{sicmedPatient.patientNumber},'%')
			</if>
			<if test="caseTell != null and caseTell != ''">
				AND a.case_tell = #{caseTell}
			</if>
			<if test="caseHistory != null and caseHistory != ''">
				AND a.case_history = #{caseHistory}
			</if>
			<if test="pastHistory != null and pastHistory != ''">
				AND a.past_history = #{pastHistory}
			</if>
			<if test="familyAllergy != null and familyAllergy != ''">
				AND a.family_allergy = #{familyAllergy}
			</if>
			<if test="checkCodeBody != null and checkCodeBody != ''">
				AND a.check_code_body = #{checkCodeBody}
			</if>
			<if test="checkCodeAid != null and checkCodeAid != ''">
				AND a.check_code_aid = #{checkCodeAid}
			</if>
			<if
				test="diagnosisDiseaseInitial != null and diagnosisDiseaseInitial != ''">
				AND a.diagnosis_disease_initial = #{diagnosisDiseaseInitial.id}
			</if>
			<if test="diagnosisDiseaseSure != null and diagnosisDiseaseSure.id != '' and diagnosisDiseaseSure.id != null ">
				AND a.diagnosis_disease_sure = #{diagnosisDiseaseSure.id}
			</if>
			<if test="caseAllergy != null and caseAllergy != ''">
				AND a.case_allergy = #{caseAllergy}
			</if>
			<if test="caseDiagnosis != null and caseDiagnosis != ''">
				AND a.case_diagnosis = #{caseDiagnosis}
			</if>

			<if
				test="beginCreateDate != null and beginCreateDate != '' ">
				AND a.create_date &gt; #{beginCreateDate}
			</if>
			<if
				test="endCreateDate != null and endCreateDate != ''">
				AND a.create_date &lt; #{endCreateDate} 
			</if>
			<if test="updateBy != null and updateBy.id != null and updateBy.id != ''">
				AND a.update_by = #{updateBy.id}
			</if>
			<if
				test="beginUpdateDate != null and endUpdateDate != null and beginUpdateDate != '' and endUpdateDate != ''">
				AND a.update_date BETWEEN #{beginUpdateDate} AND
				#{endUpdateDate}
			</if>
			<if test="delFlag != null and delFlag != ''">
				AND a.del_flag = #{delFlag}
			</if> 
			<if test="createUser != null and createUser.id != '' and createUser.id !=null ">
				AND a.create_user = #{createUser.id}
			</if>
		<!-- 	<if test="createUser != null and createUser.userName != '' and createUser.userName !=null ">
				AND u.user_name = #{createUser.userName}
			</if> -->
			<if test="createUser != null and createUser.userName != '' and createUser.userName !=null ">
				AND u.user_name LIKE CONCAT('%',#{createUser.userName},'%')
			</if>
			<if test="updateUser != null and updateUser.id != '' and updateUser.id !=null ">
				AND a.update_user = #{updateUser.id}
			</if><if test="updateUser != null and updateUser.userName != '' and updateUser.userName !=null ">
				AND s.user_name = #{updateUser.userName}
			</if>
			<!-- <if test="sicmedAsked != null and sicmedAsked.sicmedAskedClass != null and sicmedAsked.sicmedAskedClass.askedCalss != null and sicmedAsked.sicmedAskedClass.askedCalss != ''">
				AND b.asked_calss = #{sicmedAsked.sicmedAskedClass.askedCalss}
			</if> -->
			<if test="sicmedAsked != null and sicmedAsked.sicmedAskedClass != null and sicmedAsked.sicmedAskedClass.askedCalss != null and sicmedAsked.sicmedAskedClass.askedCalss != ''">
				AND b.asked_calss LIKE CONCAT('%',#{sicmedAsked.sicmedAskedClass.askedCalss},'%')
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	
	<select id="findListWithDate" resultType="SicmedCase">
		SELECT
		<include refid="sicmedCaseColumns" />
		FROM sicmed_case a
		<include refid="sicmedCaseJoins" />
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}

			<if test="beginCreateDate != null and beginCreateDate != '' 
			and createUser != null and createUser.id != '' and createUser.id !=null">
				AND a.create_date &gt; #{beginCreateDate} AND a.create_user = #{createUser.id}
			</if>
			<if test="endCreateDate != null and endCreateDate != ''
				and createUser != null and createUser.id != '' and createUser.id !=null">
				AND a.create_date &lt; #{endCreateDate} AND a.create_user = #{createUser.id}
			</if>

			<if test="beginCreateDate != null and beginCreateDate != '' 
				and endCreateDate != null and endCreateDate != ''
				and createUser != null and createUser.id != '' and createUser.id !=null">
				AND a.create_user = #{createUser.id}
				AND a.create_date BETWEEN #{beginCreateDate} AND #{endCreateDate}
			</if>
			<if test="delFlag != null and delFlag != ''">
				AND a.del_flag = #{delFlag}
			</if> 
			<if test="createUser != null and createUser.id != '' and createUser.id !=null ">
				AND a.create_user = #{createUser.id}
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	
</mapper>